@echo off
chcp 65001 >nul
title Verceléƒ¨ç½²æ›´æ–°å·¥å…·

echo.
echo ==========================================
echo           æ›´æ–° Vercel éƒ¨ç½²
echo          ï¼ˆä¿®å¤ç‰ˆæœ¬ v2.1ï¼‰
echo ==========================================
echo.

cd /d "%~dp0"

echo ðŸ“ å½“å‰ç›®å½•: %CD%
echo.

:: æ£€æŸ¥å¿…è¦æ–‡ä»¶
echo [1/4] ðŸ” æ£€æŸ¥å¿…è¦æ–‡ä»¶...
if not exist "static\script.js" (
    echo âŒ æœªæ‰¾åˆ° static/script.js æ–‡ä»¶
    pause
    exit /b 1
)

:: æ£€æŸ¥æ˜¯å¦åŒ…å«æœ€æ–°ä¿®å¤
echo [2/4] ðŸ”§ éªŒè¯ä¿®å¤å†…å®¹...
findstr /C:"isStaticDemo" static\script.js >nul
if errorlevel 1 (
    echo âŒ è­¦å‘Šï¼šscript.js å¯èƒ½ä¸åŒ…å«æœ€æ–°çš„ä¿®å¤ä»£ç 
    echo    è¯·ç¡®ä¿å·²åº”ç”¨æœ€æ–°çš„é”™è¯¯ä¿®å¤è¡¥ä¸
    pause
) else (
    echo âœ… æ£€æµ‹åˆ°æœ€æ–°çš„é™æ€æ¼”ç¤ºåŠŸèƒ½ä»£ç 
)

findstr /C:"showDemoWelcome" static\script.js >nul
if errorlevel 1 (
    echo âŒ è­¦å‘Šï¼šç¼ºå°‘æ¼”ç¤ºæ¬¢è¿ŽåŠŸèƒ½
    echo    éƒ¨ç½²åŽå¯èƒ½æ— æ³•æ­£ç¡®æ˜¾ç¤ºé™æ€æ¼”ç¤º
    pause
) else (
    echo âœ… æ¼”ç¤ºåŠŸèƒ½ä»£ç å®Œæ•´
)

echo.
echo [3/4] ðŸ“¦ æŽ¨é€æœ€æ–°æ›´æ”¹åˆ°GitHub...
git status

echo.
echo ðŸ“¦ æ·»åŠ æ‰€æœ‰æ›´æ”¹...
git add .

echo.
echo ðŸ’¾ åˆ›å»ºæ›´æ–°æäº¤...
git commit -m "fix: ä¿®å¤Verceléƒ¨ç½²çš„CORSå’ŒAPIè¿žæŽ¥é”™è¯¯

- âœ¨ æ–°å¢žé™æ€æ¼”ç¤ºæ¨¡å¼ï¼Œè§£å†³APIè¿žæŽ¥å¤±è´¥é—®é¢˜
- ðŸŒ ä¼˜åŒ–ç”Ÿäº§çŽ¯å¢ƒé”™è¯¯å¤„ç†å’Œç”¨æˆ·æç¤º
- ðŸš€ æ·»åŠ æ¼”ç¤ºæ•°æ®å’Œäº¤äº’åŠŸèƒ½ï¼Œæå‡ç”¨æˆ·ä½“éªŒ
- ðŸ“š æä¾›å®Œæ•´çš„æœ¬åœ°éƒ¨ç½²æŒ‡å¯¼å’Œè¯´æ˜Žæ–‡æ¡£
- ðŸ”§ ä¿®å¤å¤šæ ‡ç­¾é¡µçŠ¶æ€ç®¡ç†å’Œè¯·æ±‚å–æ¶ˆé—®é¢˜"

echo.
echo ðŸš€ æŽ¨é€æ›´æ–°åˆ°GitHub...
git push origin main

if errorlevel 1 (
    echo âŒ æŽ¨é€å¤±è´¥ï¼Œå°è¯•é‡æ–°æŽ¨é€...
    git push origin main --force-with-lease
    if errorlevel 1 (
        echo âŒ æŽ¨é€ä»ç„¶å¤±è´¥
        echo.
        echo å¯èƒ½çš„è§£å†³æ–¹æ¡ˆï¼š
        echo 1. æ£€æŸ¥ç½‘ç»œè¿žæŽ¥
        echo 2. æ£€æŸ¥Gitå‡­æ®ï¼šgit config --list
        echo 3. æ‰‹åŠ¨æŽ¨é€ï¼šgit push origin main
        pause
        exit /b 1
    )
)

echo.
echo [4/4] âœ… éƒ¨ç½²æ›´æ–°å®Œæˆï¼
echo.
echo ==========================================
echo âœ¨ æ›´æ–°å†…å®¹æ‘˜è¦
echo ==========================================
echo ðŸ”§ ä¿®å¤CORSå’ŒAPIè¿žæŽ¥é”™è¯¯
echo ðŸŒ æ–°å¢žé™æ€æ¼”ç¤ºæ¨¡å¼
echo ðŸš€ ä¼˜åŒ–ç”¨æˆ·ä½“éªŒå’Œé”™è¯¯æç¤º
echo ðŸ“š æ·»åŠ å®Œæ•´éƒ¨ç½²æŒ‡å¯¼
echo ðŸ“± ä¿®å¤å¤šæ ‡ç­¾é¡µçŠ¶æ€ç®¡ç†
echo ==========================================
echo.
echo ðŸ“ Vercelä¼šè‡ªåŠ¨æ£€æµ‹åˆ°æ›´æ”¹å¹¶é‡æ–°éƒ¨ç½²
echo ðŸŒ è¯·ç­‰å¾…3-5åˆ†é’ŸåŽè®¿é—®ä½ çš„Vercel URL
echo.
echo ðŸ’¡ çŽ°åœ¨çš„éƒ¨ç½²ç‰ˆæœ¬å°†ï¼š
echo    â€¢ åœ¨é™æ€çŽ¯å¢ƒä¸‹æ˜¾ç¤ºæ¼”ç¤ºæ•°æ®
echo    â€¢ æä¾›æ¸…æ™°çš„é”™è¯¯æç¤ºå’Œè§£å†³æ–¹æ¡ˆ
echo    â€¢ å¼•å¯¼ç”¨æˆ·è¿›è¡Œæœ¬åœ°éƒ¨ç½²ä»¥èŽ·å¾—å®Œæ•´åŠŸèƒ½
echo.
echo ðŸŒ æ­£åœ¨æ‰“å¼€VercelæŽ§åˆ¶å°...
start https://vercel.com/dashboard

echo.
echo æŒ‰ä»»æ„é”®å…³é—­çª—å£...
pause >nul